# spotter.yaml
# Global Configuration
log-level: info
verbose: true
no-color: false
timeout: 5m
output: table
output-file: ""
kubeconfig: ""

# Common scan options (applies to all scan types)
include-rules: []
exclude-rules: []
categories: []
parallelism: 4
min-severity: ""
max-violations: 0
quiet: false
summary-only: false

# Scan-specific configurations
scan:
  # Cluster scanning configuration
  cluster:
    namespace: []
    exclude-namespaces: []
    exclude-system-namespaces: false
    resource-types: []
    include-cluster-resources: true
    context: ""

  # Manifest scanning configuration  
  manifests:
    recursive: true
    file-extensions: [".yaml", ".yml", ".json"]
    include-paths: []
    follow-symlinks: false
    exclude-system-namespaces: false
    include-cluster-resources: true

  # Helm chart scanning configuration
  helm:
    values: []
    set: []
    set-string: []
    release-name: "test-release"
    namespace: "default"
    include-dependencies: true
    validate-schema: true
    kube-version: ""
    chart-repo: ""
    chart-version: ""
    update-dependencies: false
    exclude-system-namespaces: false
    include-cluster-resources: true
    skip-tests: false
    skip-crds: false

# External rules configuration
rules-path: []

# Kubernetes configuration
kubernetes:
  # Path to kubeconfig file
  kubeconfig: "~/.kube/config"
  # Kubernetes context to use
  context: ""
  # Timeout for Kubernetes API calls
  timeout: 30s
  # Namespace for operations (when applicable)
  namespace: ""
  
  # Client configuration for production environments
  client:
    # Queries per second - how many requests per second (default: 50)
    qps: 50.0
    # Maximum number of requests that can be made in a burst (default: 100)
    burst: 100
    # Maximum number of concurrent API workers (default: 5)
    max_concurrency: 5
    # Retry configuration
    retry:
      # Maximum number of retry attempts (default: 3)
      max_attempts: 3
      # Base delay for exponential backoff in milliseconds (default: 100)
      base_delay_ms: 100
      # Maximum delay between retries in seconds (default: 5)
      max_delay_s: 5
