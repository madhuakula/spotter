- name: insecure sample 1 should fail
  pass: false
  input: |-
    apiVersion: v1
    kind: Secret
    metadata:
      name: cluster-secrets
    data:
      # Fill with your encoded base64 CA
      certificate-authority-data: Cg==
    stringData:
      # Fill with your string Token
      bearerToken: "my-token"
- name: secure sample 1 should pass
  pass: true
  input: "apiVersion: secrets-store.csi.x-k8s.io/v1\nkind: SecretProviderClass\nmetadata:\n\
    \  name: azure-kvname\n  namespace: myNameSpace\nspec:\n  provider: azure\n  parameters:\n\
    \    usePodIdentity: \"true\"              \n    keyvaultName: \"<key Vault Name>\"\
    \               \n    objects:  |\n      array:\n        - |\n          objectName:\
    \ secret1          \n          objectType: secret                            \
    \          \n        - |\n          objectName: key1               \n        \
    \  objectType: key\n    tenantId: \"<tenant ID which the Key Vault sits under\"\
    \            \n  secretObjects:                             \n  - secretName:\
    \ appsecrets   \n    data:\n    - key: secret1                          \n   \
    \   objectName: secret1                                        \n    type: Opaque"
- name: secure sample 2 should pass
  pass: true
  input: |-
    apiVersion: v1
    kind: Secret
    metadata:
      name: cluster-secrets
    data:
      # Fill with your encoded base64 CA
      certificate-authority-data: Cg==
    stringData:
      # Fill with your string Token
      bearerToken: "my-token"
- name: secure sample 3 should pass
  pass: true
  input: "apiVersion: secrets-store.csi.x-k8s.io/v1\nkind: SecretProviderClass\nmetadata:\n\
    \  name: azure-kvname\n  namespace: myNameSpace\nspec:\n  provider: azure\n  parameters:\n\
    \    usePodIdentity: \"true\"              \n    keyvaultName: \"<key Vault Name>\"\
    \               \n    objects:  \n      array:\n        - {objectName: secret1,\
    \ objectType: secret}\n        - {objectName: key1 , objectType: key}        \
    \                              \n    tenantId: \"<tenant ID which the Key Vault\
    \ sits under\"            \n  secretObjects:                             \n  -\
    \ secretName: appsecrets   \n    data:\n    - key: secret1                   \
    \       \n      objectName: secret1                                        \n\
    \    type: Opaque"
