- name: insecure sample 1 should fail
  pass: false
  input: |-
    apiVersion: v1
    kind: Pod
    metadata:
      name: test-pd
    spec:
      containers:
      - image: k8s.gcr.io/test-webserver
        name: test-container
        volumeMounts:
        - mountPath: /test-pd
          name: test-volume
      volumes:
      - name: test-volume
        hostPath:
          path: /var/run/docker.sock
          type: Directory
- name: insecure sample 2 should fail
  pass: false
  input: |-
    apiVersion: v1
    kind: ReplicationController
    metadata:
      name: node-manager
      labels:
        name: node-manager
    spec:
        selector:
          name: node-manager
        template:
          metadata:
            labels:
              name: node-manager
          spec:
              containers:
              - image: k8s.gcr.io/test-webserver
                name: test-container
                volumeMounts:
                - mountPath: /test-pd
                  name: test-volume
              volumes:
              - name: test-volume
                hostPath:
                  path: /var/run/docker.sock
                  type: Directory
- name: insecure sample 3 should fail
  pass: false
  input: |-
    apiVersion: batch/v1beta1
    kind: CronJob
    metadata:
      name: hello
    spec:
      schedule: "*/1 * * * *"
      jobTemplate:
        spec:
          template:
            spec:
              containers:
              - image: k8s.gcr.io/test-webserver
                name: test-container
                volumeMounts:
                - mountPath: /test-pd
                  name: test-volume
              volumes:
              - name: test-volume
                hostPath:
                  path: /var/run/docker.sock
                  type: Directory
- name: secure sample 1 should pass
  pass: true
  input: |-
    apiVersion: v1
    kind: Pod
    metadata:
      name: test-pd
    spec:
      containers:
      - image: k8s.gcr.io/test-webserver
        name: test-container
        volumeMounts:
        - mountPath: /test-pd
          name: test-volume
      volumes:
      - name: test-volume
        hostPath:
          path: /data
          type: Directory
