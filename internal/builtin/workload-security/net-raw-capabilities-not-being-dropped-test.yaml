- name: insecure sample 1 should fail
  pass: false
  input: |-
    apiVersion: v1
    kind: Pod
    metadata:
      name: example
    spec:
      containers:
          - name: payment
            image: nginx
            securityContext:
              capabilities:
                drop:
                  - SYS_ADMIN
          - name: payment2
            image: nginx
          - name: payment4
            image: nginx
            securityContext:
              capabilities:
                add:
                  - NET_BIND_SERVICE
          - name: payment3
            image: nginx
            securityContext:
              allowPrivilegeEscalation: false
- name: insecure sample 2 should fail
  pass: false
  input: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: redis-unhealthy-deployment\n\
    \  labels:\n    app: redis\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n\
    \      app: redis\n  template:\n    metadata:      \n      labels:\n        app:\
    \ redis\n    spec:\n      hostNetwork: true\n      hostPID: true \n      hostIPC:\
    \ true\n      containers:\n      - name: redis\n        image: redis:latest\n\
    \        ports:\n        - containerPort: 9001\n          hostPort: 9001\n   \
    \     securityContext:\n          privileged: true\n          readOnlyRootFilesystem:\
    \ false\n          allowPrivilegeEscalation: true\n          runAsUser: 0\n  \
    \        capabilities:\n            add:\n              - NET_ADMIN"
- name: secure sample 1 should pass
  pass: true
  input: |-
    apiVersion: policy/v1beta1
    kind: PodSecurityPolicy
    metadata:
      name: example
    spec:
      containers:
          - name: payment
            image: nginx
            securityContext:
              capabilities:
                drop:
                  - ALL
                add:
                  - NET_BIND_SERVICE
      privileged: false
      seLinux:
        rule: RunAsAny
      supplementalGroups:
        rule: RunAsAny
      runAsUser:
        rule: RunAsAny
      fsGroup:
        rule: RunAsAny
      volumes:
      - '*'
