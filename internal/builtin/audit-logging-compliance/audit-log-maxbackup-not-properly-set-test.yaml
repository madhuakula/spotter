- name: insecure sample 1 should fail
  pass: false
  input: |
    apiVersion: v1
    kind: Pod
    metadata:
      name: command-demo
      labels:
        purpose: demonstrate-command
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: ["kube-apiserver"]
          args: ["--audit-log-maxbackup=5"]
      restartPolicy: OnFailure

- name: insecure sample 2 should fail
  pass: false
  input: |
    apiVersion: v1
    kind: Pod
    metadata:
      name: command-demo
      labels:
        purpose: demonstrate-command
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: ["kube-apiserver"]
          args: []
      restartPolicy: OnFailure

- name: insecure sample 3 should fail
  pass: false
  input: |
    apiVersion: serving.knative.dev/v1
    kind: Service
    metadata:
      name: dummy
      namespace: knative-sequence
    spec:
      template:
        spec:
          containers:
          - name: command-demo-container
            image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
            command: ["kube-apiserver"]
            args: ["--audit-log-maxbackup=5"]
        restartPolicy: OnFailure
    ---
    apiVersion: serving.knative.dev/v1
    kind: Configuration
    metadata:
      name: dummy-config
      namespace: knative-sequence
    spec:
      template:
        spec:
          containers:
            - name: command-demo-container
              image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
              command: ["kube-apiserver"]
              args: ["--audit-log-maxbackup=5"]
          restartPolicy: OnFailure
    ---
    apiVersion: serving.knative.dev/v1
    kind: Revision
    metadata:
      name: dummy-rev
      namespace: knative-sequence
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: ["kube-apiserver"]
          args: ["--audit-log-maxbackup=5"]
      restartPolicy: OnFailure
    ---
    apiVersion: sources.knative.dev/v1
    kind: ContainerSource
    metadata:
      name: dummy-cs
      namespace: knative-sequence
    spec:
      template:
        spec:
          containers:
            - name: command-demo-container
              image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
              command: ["kube-apiserver"]
              args: ["--audit-log-maxbackup=5"]
          restartPolicy: OnFailure


- name: secure sample 1 should pass
  pass: true
  input: |
    apiVersion: v1
    kind: Pod
    metadata:
      name: command-demo
      labels:
        purpose: demonstrate-command
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: ["kube-apiserver"]
          args: ["--audit-log-maxbackup=10"]
      restartPolicy: OnFailure
  
- name: secure sample 2 should pass
  pass: true
  input: |
    apiVersion: v1
    kind: Pod
    metadata:
      name: command-demo
      labels:
        purpose: demonstrate-command
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: ["kube-apiserver","--audit-log-maxbackup=15"]
          args: []
      restartPolicy: OnFailure
