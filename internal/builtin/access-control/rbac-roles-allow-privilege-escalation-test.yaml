- name: insecure sample 1 should fail
  pass: false
  input: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: rbac-binder
      namespace: kube-system
    rules:
    - apiGroups:
      - rbac.authorization.k8s.io
      resources:
      - clusterroles
      verbs:
      - bind
    - apiGroups:
      - rbac.authorization.k8s.io
      resources:
      - clusterrolebindings
      verbs:
      - create

- name: secure sample 1 should pass
  pass: true
  input: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: not-rbac-binder
      namespace: kube-system
    rules:
    - apiGroups:
      - rbac.authorization.k8s.io
      resources:
      - clusterrolebindings
      verbs:
      - create
