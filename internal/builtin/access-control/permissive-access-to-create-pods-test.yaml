- name: insecure sample 1 should fail
  pass: false
  input: |-
    #this is a problematic code where the query should report a result(s)
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader
    rules:
    - apiGroups: [""]
      resources: ["pods"]
      verbs:
        - "get"
        - "watch"
        - create
- name: insecure sample 2 should fail
  pass: false
  input: |-
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      name: secret-reader2
    rules:
    - apiGroups: [""]
      resources: ["*"]
      verbs: ["get", "watch", "create"]
- name: insecure sample 3 should fail
  pass: false
  input: |-
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader3
    rules:
    - apiGroups: [""]
      resources: ["pods"]
      verbs: ["get", "watch", "*"]
- name: insecure sample 4 should fail
  pass: false
  input: |-
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      name: secret-reader4
    rules:
    - apiGroups: [""]
      resources: ["*"]
      verbs: ["get", "watch", "*"]
- name: insecure sample 5 should fail
  pass: false
  input: |-
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader5
    rules:
    - apiGroups: [""]
      resources: ["pods"]
      verbs:
        - "get"
        - "watch"
        - "c*e"
- name: insecure sample 6 should fail
  pass: false
  input: |-
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader6
    rules:
    - apiGroups: [""]
      resources: ["p*ds"]
      verbs: ["get", "watch", "create"]
- name: insecure sample 7 should fail
  pass: false
  input: |-
    #this is a problematic code where the query should report a result(s)
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader
    rules:
      - apiGroups:
          - "*"
        resources:
          - "*"
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - apiextensions.k8s.io
        resources:
          - custom
        verbs:
          - create
          - delete
      - apiGroups:
          - "*"
        resources:
          - "*"
        verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
- name: secure sample 1 should pass
  pass: true
  input: |-
    #this code is a correct code for which the query should not find any result
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader
    rules:
    - apiGroups: [""]

      resources: ["pods"]
      verbs: ["get", "watch", "list"]
- name: secure sample 2 should pass
  pass: true
  input: |-
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader2
    rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["get", "watch", "create"]
- name: secure sample 3 should pass
  pass: true
  input: |-
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader4
    rules:
    - apiGroups: [""]
      resources: ["pods"]
      verbs:
        - "get"
        - "watch"
- name: secure sample 4 should pass
  pass: true
  input: |-
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader
    rules:
      - apiGroups:
          - apiextensions.k8s.io
        resources:
          - "*"
        verbs:
          - create
          - delete
