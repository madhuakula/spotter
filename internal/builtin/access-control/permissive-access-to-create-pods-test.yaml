- name: insecure sample 1 should fail
  pass: false
  input: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader
      namespace: kube-system
    rules:
    - apiGroups:
      - '*'
      resources:
      - '*'
      verbs:
      - get
      - list
      - watch
    - apiGroups:
      - apiextensions.k8s.io
      resources:
      - custom
      verbs:
      - create
      - delete
    - apiGroups:
      - '*'
      resources:
      - '*'
      verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch

- name: secure sample 1 should pass
  pass: true
  input: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: secret-reader
      namespace: kube-system
    rules:
    - apiGroups:
      - apiextensions.k8s.io
      resources:
      - '*'
      verbs:
      - create
      - delete
