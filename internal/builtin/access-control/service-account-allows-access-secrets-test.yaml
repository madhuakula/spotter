- name: insecure sample 1 should fail
  pass: false
  input: |-
    #Vulnerable Role
    kind: Role
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      namespace: assembly-prod
      name: testRoleVulnerable
    rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["get", "watch", "list"]
- name: insecure sample 2 should fail
  pass: false
  input: |-
    kind: RoleBinding
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      name: testRoleBinding
      namespace: bindingTestWithBinding
    subjects:
    - kind: ServiceAccount
      name: testsa
      apiGroup: ""
    roleRef:
      kind: Role
      name: testRoleVulnerable
      apiGroup: rbac.authorization.k8s.io
- name: insecure sample 3 should fail
  pass: false
  input: |-
    kind: Role
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      namespace: assembly-prod
      name: testRoleVulnerable2
    rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["*"]
- name: insecure sample 4 should fail
  pass: false
  input: |-
    kind: RoleBinding
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      name: testRoleBinding
      namespace: bindingTestWithBinding2
    subjects:
    - kind: ServiceAccount
      name: testsa
      apiGroup: ""
    roleRef:
      kind: Role
      name: testRoleVulnerable2
      apiGroup: rbac.authorization.k8s.io
- name: insecure sample 5 should fail
  pass: false
  input: |-
    # Vulnerable Cluster Role
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: testClusterRoleVulnerable
    rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["update", "list"]
- name: insecure sample 6 should fail
  pass: false
  input: |-
    kind: ClusterRoleBinding
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      name: bindingTestClusterRoleWithBinding
      namespace: bindingTestClusterRoleWithBindingNamespace
    subjects:
    - kind: ServiceAccount
      name: testsa
      apiGroup: ""
    roleRef:
      kind: ClusterRole
      name: testClusterRoleVulnerable
      apiGroup: rbac.authorization.k8s.io
- name: secure sample 1 should pass
  pass: true
  input: |-
    # Vulnerable Role Without Binding
    kind: Role
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      namespace: assembly-prod
      name: testRoleWithoutBindingVulnerable
    rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["get", "watch", "list"]
- name: secure sample 2 should pass
  pass: true
  input: |-
    # Vulnerable Role With Binding Not Service Account
    kind: Role
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      namespace: assembly-prod
      name: testRoleWithBindingVulnerableNotSA
    rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["get", "watch", "list"]
- name: secure sample 3 should pass
  pass: true
  input: |-
    kind: RoleBinding
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      name: bindingNotSATestRoleWithBindingVulnerable
      namespace: bindingNotSATestRoleWithBindingVulnerableNamespace
    subjects:
    - kind: NotServiceAccount
      name: testsa
      apiGroup: ""
    roleRef:
      kind: Role
      name: testRoleWithBindingVulnerableNotSA
      apiGroup: rbac.authorization.k8s.io
- name: secure sample 4 should pass
  pass: true
  input: |-
    # Safe Role With Binding
    kind: Role
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      namespace: assembly-prod
      name: testRoleWithBindingSafe
    rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["update"]
- name: secure sample 5 should pass
  pass: true
  input: |-
    kind: RoleBinding
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      name: bindingtestRoleWithBindingSafe
      namespace: bindingtestRoleWithBindingSafeNamespace
    subjects:
    - kind: ServiceAccount
      name: testsa
      apiGroup: ""
    roleRef:
      kind: Role
      name: testRoleWithBindingSafe
      apiGroup: rbac.authorization.k8s.io
- name: secure sample 6 should pass
  pass: true
  input: |-
    # Vulnerable Role with Pod
    kind: Role
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      namespace: assembly-prod
      name: testRoleVulnerablePod
    rules:
    - apiGroups: [""]
      resources: ["pod"]
      verbs: ["get", "watch", "list"]
- name: secure sample 7 should pass
  pass: true
  input: |-
    kind: RoleBinding
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      name: testRoleBinding
      namespace: bindingTestWithBindingPod
    subjects:
    - kind: ServiceAccount
      name: testsa
      apiGroup: ""
    roleRef:
      kind: Role
      name: testRoleVulnerablePod
      apiGroup: rbac.authorization.k8s.io
- name: secure sample 8 should pass
  pass: true
  input: |-
    # Vulnerable Cluster Role Without Binding
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: testClusterRoleWithoutBindingVulnerable
    rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["get", "watch", "list"]
- name: secure sample 9 should pass
  pass: true
  input: |-
    # Vulnerable Cluster Role With Binding Not Service Account
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      namespace: default
      name: testClusterRoleWithBindingVulnerableNotSA
    rules:
    - apiGroups: [""] # "" indicates the core API group
      resources: ["secrets"]
      verbs: ["get", "watch", "list"]
- name: secure sample 10 should pass
  pass: true
  input: |-
    kind: ClusterRoleBinding
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      name: bindingNotSATestClusterRoleWithBindingVulnerable
      namespace: bindingNotSATestClusterRoleWithBindingVulnerableNamespace
    subjects:
    - kind: NotServiceAccount
      name: testsa
      apiGroup: ""
    roleRef:
      kind: ClusterRole
      name: testClusterRoleWithBindingVulnerableNotSA
      apiGroup: rbac.authorization.k8s.io
- name: secure sample 11 should pass
  pass: true
  input: |-
    # Safe ClusterRole With Binding
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      namespace: default
      name: testClusterRoleWithBindingSafe
    rules:
    - apiGroups: [""] # "" indicates the core API group
      resources: ["secrets"]
      verbs: ["update"]
- name: secure sample 12 should pass
  pass: true
  input: |-
    kind: ClusterRoleBinding
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      name: bindingTestClusterRoleWithBindingSafe
      namespace: bindingTestClusterRoleWithBindingSafeNamespace
    subjects:
    - kind: NotServiceAccount
      name: testsa
      apiGroup: ""
    roleRef:
      kind: ClusterRole
      name: testClusterRoleWithBindingSafe
      apiGroup: rbac.authorization.k8s.io
- name: secure sample 13 should pass
  pass: true
  input: |-
    # Vulnerable Cluster Role With Pod
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      name: testClusterRoleVulnerablePod
    rules:
    - apiGroups: [""]
      resources: ["pod"]
      verbs: ["update", "list"]
- name: secure sample 14 should pass
  pass: true
  input: |-
    kind: ClusterRoleBinding
    apiVersion: rbac.authorization.k8s.io/v1
    metadata:
      name: bindingTestClusterRoleWithBinding
      namespace: bindingTestClusterRoleWithBindingNamespace
    subjects:
    - kind: ServiceAccount
      name: testsa
      apiGroup: ""
    roleRef:
      kind: ClusterRole
      name: testClusterRoleVulnerablePod
      apiGroup: rbac.authorization.k8s.io
