- name: insecure sample 1 should fail
  pass: false
  input: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      namespace: my-namespace
      name: allow-port-forward
    rules:
    - apiGroups: [""]
      resources: ["pods", "pods/portforward"]
      verbs: ["get", "list", "create"]
    ---
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      name: allow-port-forward
      namespace: my-namespace
    subjects:
    - kind: User
      name: bob
      apiGroup: rbac.authorization.k8s.io
    roleRef:
      kind: Role
      name: allow-port-forward
      apiGroup: ""

- name: secure sample 1 should pass
  pass: true
  input: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      namespace: my-namespace
      name: allow-port-forward-neg
    rules:
    - apiGroups: [""]
      resources: ["pods"]
      verbs: ["get", "list", "create"]
    ---
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      name: allow-port-forward-neg
      namespace: my-namespace
    subjects:
    - kind: User
      name: bob
      apiGroup: rbac.authorization.k8s.io
    roleRef:
      kind: Role
      name: allow-port-forward-neg
      apiGroup: ""
