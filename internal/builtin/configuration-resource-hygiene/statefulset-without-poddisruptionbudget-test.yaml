- name: insecure sample 1 should fail
  pass: false
  input: |-
    apiVersion: policy/v1beta1
    kind: PodDisruptionBudget
    metadata:
      name: nginx-pdb
    spec:
      maxUnavailable: 1
      selector:
        matchLabels:
          app: xpto
- name: insecure sample 2 should fail
  pass: false
  input: |-
    apiVersion: apps/v1
    kind: StatefulSet
    metadata:
      name: web
    spec:
      requiredDropCapabilities:
        - ALL
      selector:
        matchLabels:
          app: nginx
      serviceName: "nginx"
      replicas: 3
      template:
        metadata:
          labels:
            app: nginx
        spec:
          terminationGracePeriodSeconds: 10
          containers:
          - name: nginx
            image: k8s.gcr.io/nginx-slim:0.8
            ports:
            - containerPort: 80
              name: web
            volumeMounts:
            - name: www
              mountPath: /usr/share/nginx/html
- name: secure sample 1 should pass
  pass: true
  input: |-
    apiVersion: policy/v1beta1
    kind: PodDisruptionBudget
    metadata:
      name: nginx-pdb
    spec:
      maxUnavailable: 1
      selector:
        matchLabels:
          app: nginx33
          run: test
- name: secure sample 2 should pass
  pass: true
  input: |-
    apiVersion: apps/v1
    kind: StatefulSet
    metadata:
      name: web
    spec:
      selector:
        matchLabels:
          app: nginx123
          run: test
      serviceName: "nginx"
      replicas: 3
      template:
        metadata:
          labels:
            app: nginx
        spec:
          terminationGracePeriodSeconds: 10
          containers:
          - name: nginx
            image: k8s.gcr.io/nginx-slim:0.8
            ports:
            - containerPort: 80
              name: web
            volumeMounts:
            - name: www
              mountPath: /usr/share/nginx/html
